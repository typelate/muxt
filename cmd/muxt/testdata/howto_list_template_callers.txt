# Tests filtering template callers with --template flag

muxt list-template-callers --match=header
stdout 'template "header" called by:'
! stdout 'template "footer" called by:'

muxt list-template-callers --match=header --match=footer
stdout 'template "header" called by:'
stdout 'template "footer" called by:'
! stdout 'template "layout" called by:'

# 'callers' is an alias for 'list-template-callers'
muxt callers --match=header
stdout 'template "header" called by:'
! stdout 'template "footer" called by:'

-- go.mod --
module server

go 1.22
-- template.go --
package server

import (
	"embed"
	"html/template"
	"io"
)

//go:embed *.gohtml
var templateSource embed.FS

var templates = template.Must(template.ParseFS(templateSource, "*"))

type T struct{}

func init() {
	_ = templates.ExecuteTemplate(io.Discard, "layout", T{})
}

-- layout.gohtml --
{{define "layout"}}
<div>
{{template "header" .}}
{{template "footer" .}}
</div>
{{end}}

-- header.gohtml --
{{define "header"}}
<header>Header</header>
{{end}}

-- footer.gohtml --
{{define "footer"}}
<footer>Footer</footer>
{{end}}

-- page.gohtml --
{{define "GET / Page()"}}
{{template "layout" .}}
{{end}}
