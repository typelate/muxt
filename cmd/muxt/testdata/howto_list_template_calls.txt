# Tests filtering template calls with --template flag

muxt list-template-calls --match=layout
stdout 'template "layout" calls:'
! stdout 'template "page.gohtml" calls:'

muxt list-template-calls --match=layout --match='page\.gohtml'
stdout 'template "layout" calls:'
stdout 'template "page.gohtml" calls:'
! stdout 'template "header" calls:'

# 'calls' is an alias for 'list-template-calls'
muxt calls --match=layout
stdout 'template "layout" calls:'
! stdout 'template "page.gohtml" calls:'

-- go.mod --
module server

go 1.22
-- template.go --
package server

import (
	"embed"
	"html/template"
	"io"
)

//go:embed *.gohtml
var templateSource embed.FS

var templates = template.Must(template.ParseFS(templateSource, "*"))

type T struct{}

func init() {
	_ = templates.ExecuteTemplate(io.Discard, "layout", T{})
	_ = templates.ExecuteTemplate(io.Discard, "page.gohtml", T{})
}
-- layout.gohtml --
{{define "layout"}}
<div>
{{template "header" .}}
{{template "footer" .}}
</div>
{{end}}

-- header.gohtml --
{{define "header"}}
<header>Header</header>
{{end}}

-- footer.gohtml --
{{define "footer"}}
<footer>Footer</footer>
{{end}}

-- page.gohtml --
{{template "layout" .}}
